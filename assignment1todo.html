<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo Javascript</title>
    <!-- Bootstrap cdn -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- font awesome cdn -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- font awesome end -->
  <style>
      table{
        margin-top:50px;
      }
        #mainRow {
        background-color: #16c9f6;
        color: #fff;
     }
     tr{
      line-height: 40px; 
     }
    .formSection,.displayData{
      padding: 50px;
      width: 100%;
      height: 100vh;
      position: relative;
     }
    .formSection::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      left: 0;
      bottom: 0;
      z-index: -1;
      background:linear-gradient(330deg, #16c9f6 55%,#fff 0%);
   }
   .displayData::before {
    content: '';
      position: absolute;
      top: 0;
      right: 0;
      left: 0;
      bottom: 0;
      z-index: -1; 
   }
   .form-button button{
    border-radius: 100px !important;
    padding: 12px 35px !important;
    margin: 0px 5px;
    border: 1px solid #50d1c0;;
    color: #50d1c0;
    outline: none;
    font-size: 1rem;
    font-weight: 400;
    text-align: center;
    background-color: transparent;
   }
   form:hover .form-button button{
    color: #50d1c0 !important;
    background-color: #fff !important;
  }

  </style>
</head>

<body>
    <div class="formSection">
      <div class="container">
        <div class=" headings text-center">
          <h1 >User Profile Todo</h1>
          <p>Javascript first assignment to create basic crud operations! &#128512;.</p>
        </div>
        <div class="row">
          <div class="col-lg-8 col-md-8 col-10 offset-lg-2 offset-md-2 offset-1">
              <form action="javascript:void(0);"> 
                <div class="form-group">
                    <input type="text" id = "fName" class="form-control"  placeholder="First Name">
                </div>
                <div class="form-group">
                    <input type="text" id = "lName" class="form-control"  placeholder="Last Name">
                </div>
                <div class="form-group">
                  <input type="email" id = "email" class="form-control"  placeholder="Email address">
                </div>
                <div class="form-group">
                   <input type="text" id = "age" class="form-control"  placeholder="Age">
                </div>
                <div class="form-group">
                   <input type="text" id = "phone" class="form-control"  placeholder="Phone Number">
                </div>
                <div class="form-button d-flex justify-content-center">
                  <button type="submit" 
                      onclick="addUser()" class="btn btn-info p-2">Add User
                  </button>
                </div>  
              </form>
          </div>
        </div>
      </div>
    </div> 
     <!--Container to list users data-->
    <div class="displayData" >
      <div class="container">
        <div class="row">
          <div class="col-12" style=margin:30px 0 30px 0">
            <h2 class="text-center">Users</h2>
            <table style="width:100%;" 
            id = "tableData" class="table table-striped">
              <tr style="width:100%" id = "mainRow" class="text-center">
                <th>Id</th>
                <th>Name</th>
                <th>Age</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Action</th>
              </tr>
            </table>
          </div>
        </div>
      </div>    
    </div>


<!-- The Modal -->
<div class="modal fade" id="myModal">
  <div class="modal-dialog">
    <div class="modal-content">
    
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">Update User Record</h4>
        <button type="button" class="close" data-dismiss="modal">Ã—</button>
      </div>
      
      <!-- Modal body -->
      <div class="modal-body">
        <div class="container">
          <form action="javascript:void(0);"> 
            <div class="form-group">
              <input type="text" id = "editFName" class="form-control"  placeholder="First Name">
            </div>
            <div class="form-group">
              <input type="text" id = "editLName" class="form-control"  placeholder="Last Name">
            </div>
            <div class="form-group">
              <input type="email" id = "editEmail" class="form-control"  placeholder="Email address" required>
            </div>
            <div class="form-group">
              <input type="text" id = "editAge" class="form-control"  placeholder="Age" required>
            </div>
            <div class="form-group">
              <input type="tel" id = "editPhone" class="form-control"  
              placeholder="Phone Number" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}">
            </div>
            <div class="form-group" class = "bg-dark text-center">
               <button class="btn btn-success" type = "submit" data-dismiss="modal" id = "updateBtn"  style="min-width:100%">Update</button>
            </div>
        </form>
        </div>
      </div>
    </div>
  </div>
</div>


    <!--Bootstrap CDN  -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <!-- CDN end  -->

    <!-- Vanilla Javascript for general purpose -->
    <script>
      // Function add new user 
      var person = []; 
      var tableData = document.getElementById("tableData");
      function listData() {
        person.map(element=>{
            const nodeRow = document.createElement("tr");
            const item = document.querySelector(`[data-key='${element.id}']`);
            nodeRow.setAttribute('data-key', element.id);
            nodeRow.setAttribute('class', "text-center");
            console.log(nodeRow); 
            nodeRow.innerHTML =
              ` 
                <td>${element.id}</td>
                <td>${element.fName} ${element.lName}</td>
                <td>${element.age}</td>
                <td>${element.email}</td>
                <td>${element.phone}</td>
                <td>
                  <button data-toggle="modal" data-target="#myModal" 
                  class = "btn btn-info" value = ${element.id} id = "editUser" 
                  onclick = "editUser(this)">
                    <i class = "fa fa-edit"></i>
                </td>
              `;
              if(item){
                console.log("New Item About to added");
              }else{
                tableData.append(nodeRow);
              }
          });
      }
       function addUser(event) {
        var firstName = document.getElementById("fName"); 
        var lastName =document.getElementById("lName");
        var age = document.getElementById("age");
        var email = document.getElementById("email");
        var phone = document.getElementById("phone");
         name = firstName.value + lastName.value;
        var id = Math.random() * 1000;
        id = Math.ceil(id);
        let tr = document.createElement('tr');
        let td = document.createElement('td');
        if (firstName.value.length === 0) {
          alert("Please enter your name");
          firstName.focus();
          firstName.style.background = "yellow";
          return false;
        } else if(lastName.value.length === 0){
            alert("Please enter your name");
            lastName.focus();
            lastName.style.background = "yellow";
          return false; 
        }  else if (age.value.length === 0){
          alert("Please enter age");
            age.focus();
            age.style.background = "yellow";
          return false;
        } else if (phone.value.length === 0){
          alert("enter valid phone number");
          phone.focus();
          phone.style.backgroundColor = "yellow";
          return false;
        } else if(email.value.length === 0 || email.value.length > 30 
          ||email.value.indexOf("@") < 1 
          || email.value.indexOf("@") > email.value.length -5
          ){
            alert("Please enter a valid email");
            email.focus();
            email.style.background = "yellow";
          return false;
        } else {
          let data = {
            id:id,
            fName:firstName.value,
            lName:lastName.value,
            age:age.value,
            email:email.value,
            phone:phone.value,
          }
          person.push(data);
        }
          alert("New User Created");
          console.log(person);
          listData();
          firstName.value = '';
          lastName.value = '';
          age.value = '';
          email.value = '';
          phone.value = '';
        }
         
        
        
        // Edit User
          function editUser(e){
            person.map(elem=>{
              if (elem.id == e.value){
                  document.getElementById("editFName").value = elem.fName;
                  document.getElementById("editLName").value = elem.lName;
                  document.getElementById("editAge").value = elem.age;
                  document.getElementById("editEmail").value = elem.email;
                  document.getElementById("editPhone").value = elem.phone;
                  document.getElementById("updateBtn").value = elem.id;
              }
            })
          }
          
        
        // end edit user function

        //start update user function

        updateBtn.addEventListener("click",function(e){
          const item = document.querySelector(`[data-key='${e.target.value}']`);
          var tableData = document.getElementById("tableData");
          const node = document.createElement("tr");
          node.setAttribute('data-key', e.target.value);
          if(item){
            tableData.removeChild(item);
            person.map(elem=>{
            console.log(elem);
              if(elem.id == e.target.value){
                  elem.fName = document.getElementById("editFName").value;
                  elem.lName =  document.getElementById("editLName").value;
                  elem.age = document.getElementById("editAge").value;
                  elem.email = document.getElementById("editEmail").value;
                  elem.phone = document.getElementById("editPhone").value;
                  alert(elem.fName +" updated at " + elem.id );
                  listData();
              }
          });
          }
        });
        // End update


  // End Function
     
    </script>
</body>
</html>